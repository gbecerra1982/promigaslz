{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "environmentName": { "value": "AZR-GENIA-PREPRD-EASTUS" },
    "location": { "value": "eastus" },
    "aiFoundryLocation": { "value": "eastus" },
    "psqlLocation": { "value": "eastus" },
    "cosmosLocation": { "value": "eastus" },

    "deploymentTags": {
      "value": {
        "Responsable": "Diego Bogota",
        "Ambiente": "PREPRD",
        "AprobadoPor": "Diego Bogota",
        "Aplicación": "GENAI",
        "Compañía": "Promigas",
        "CreadoPor": "Diego Garcia TI724",
        "FechaCreación": "2025-09-19",
        "Proyecto": "LZ AZURE"
      }
    },

    "principalId": { "value": "${AZURE_PRINCIPAL_ID}" },

    "networkIsolation": { "value": "true" },
    "useUAI": { "value": "${USE_UAI}" },
    "useCAppAPIKey": { "value": "${USE_CAPP_API_KEY}" },
    "useZoneRedundancy": { "value": "false" },

    "aiSearchResourceId": { "value": null },
    "aiFoundryStorageAccountResourceId": { "value": null },
    "aiFoundryCosmosDBAccountResourceId": { "value": null },

    "deployAiFoundry": { "value": "true" },
    "deployAiFoundrySubnet": { "value": "false" },
    "deployAppConfig": { "value": "true" },
    "deployAppInsights": { "value": "true" },
    "deployCosmosDb": { "value": "true" },
    "deployContainerApps": { "value": "true" },
    "deployContainerRegistry": { "value": "true" },
    "deployContainerEnv": { "value": "true" },
    "deployNsgs": { "value": "true" },
    "deployMcp": { "value": "true" },
    "deployGroundingWithBing": { "value": "false" },
    "deployKeyVault": { "value": "true" },
    "deployVmKeyVault": { "value": "${DEPLOY_VM_KEY_VAULT}" },
    "deployLogAnalytics": { "value": "true" },
    "deploySearchService": { "value": "true" },
    "deployStorageAccount": { "value": "true" },
    "greenFieldDeployment": { "value": "true" },
    "deployVM": { "value": "true" },
    "deploySoftware": { "value": "true" },
    "deployPostgres": { "value": "false" },

    "aiFoundryAccountName": { "value": "aifoundryazrgeniaeastus" },
    "aiFoundryProjectName": { "value": "aifproject" },
    "aiFoundryProjectDisplayName": { "value": "aifproyecto de prueba" },
    "aiFoundryProjectDescription": { "value": "aifproyecto de prueba" },
    "aiFoundryStorageAccountName": { "value": "aifstgenia001" },
    "aiFoundrySearchServiceName": { "value": "aifsearch-azr-genia-eastus" },
    "aiFoundryCosmosDbName": { "value": "aifcosmosgenia01" },
    "bingSearchName": { "value": "bingsearch-azr-genia-eastus" },
    "appConfigName": { "value": "appcf3-azr-genia-eastus" },
    "appInsightsName": { "value": "appins-azr-genia-eastus" },
    "containerEnvName": { "value": "acaenv-azr-genia-eastus" },
    "containerRegistryName": { "value": "acrazrgeniaeastus" },
    "conversationContainerName": { "value": "acaconvert-azr-genia-eastus" },
    "dataIngestContainerAppName": { "value": "acadata-azr-genia-eastus" },
    "datasourcesContainerName": { "value": "datasr-azr-genia-eastus" },
    "dbAccountName": { "value": "cosmosazrgeniaeastus" },
    "dbDatabaseName": { "value": "cosmosdb-azr-genia-eastus" },
    "frontEndContainerAppName": { "value": "acafront-azr-genia-eastus" },
    "keyVaultName": { "value": "kv3-azr-genia-eastus" },
    "logAnalyticsWorkspaceName": { "value": "law-azr-genia-eastus" },
    "searchServiceName": { "value": "search-azr-genia-eastus" },
    "solutionStorageAccountName": { "value": "stgenia001" },

    "vmAdminPassword": { "value": "$(secretOrRandomPassword)" },
    "vmSize": { "value": "Standard_D4s_v3" },

    "useCMK": { "value": "false" },
    "useExistingVNet": { "value": "false" },
    "deploySubnets": { "value": "true" },
    "sideBySideDeploy": { "value": "${SIDE_BY_SIDE}" },
    "virtualNetworkName": { "value": "VNET-AZR-GENIA-PREPRD-EASTUS" },
    "vnetAddressPrefixes": { "value": [ "10.62.0.0/16" ] },
    "virtualNetworkResourceGroup": { "value": "${VNET_RESOURCE_GROUP_NAME}" },

    "modelDeploymentList": {
      "value": [
        {
          "name": "chat",
          "model": "gpt-4o",
          "modelFormat": "OpenAI",
          "type": "GlobalStandard",
          "version": "2024-11-20",
          "apiVersion": "2025-01-01-preview",
          "capacity": 40,
          "canonical_name": "CHAT_DEPLOYMENT_NAME"
        },
        {
          "name": "text-embedding",
          "model": "text-embedding-3-large",
          "modelFormat": "OpenAI",
          "type": "Standard",
          "version": "1",
          "apiVersion": "2025-01-01-preview",
          "capacity": 40,
          "canonical_name": "EMBEDDING_DEPLOYMENT_NAME"
        }
      ]
    },

    "workloadProfiles": {
      "value": [
        {
          "name": "Consumption",
          "workloadProfileType": "Consumption"
        },
        {
          "workloadProfileType": "D4",
          "name": "main",
          "minimumCount": 0,
          "maximumCount": 1
        }
      ]
    },

    "storageAccountContainersList": {
      "value": [
        {
          "name": "documents-images",
          "canonical_name": "DOCUMENTS_IMAGES_STORAGE_CONTAINER"
        },
        {
          "name": "documents",
          "canonical_name": "DOCUMENTS_STORAGE_CONTAINER"
        },
        {
          "name": "nl2sql",
          "canonical_name": "NL2SQL_STORAGE_CONTAINER"
        }
      ]
    },

    "databaseContainersList": {
      "value": [
        {
          "name": "conversations",
          "canonical_name": "CONVERSATIONS_DATABASE_CONTAINER"
        },
        {
          "name": "datasources",
          "canonical_name": "DATASOURCES_DATABASE_CONTAINER"
        },
        {
          "name": "prompts",
          "canonical_name": "PROMPTS_CONTAINER"
        },
        {
          "name": "mcp",
          "canonical_name": "MCP_CONTAINER"
        }
      ]
    },

    "containerAppsList": {
      "value": [
        {
          "name": null,
          "external": true,
          "service_name": "orchestrator",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "ORCHESTRATOR_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "AcrPull",
            "CosmosDBBuiltInDataContributor",
            "SearchIndexDataReader",
            "StorageBlobDataReader",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external": true,
          "service_name": "frontend",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "FRONTEND_APP",
          "roles": [
            "AppConfigurationDataReader",
            "AcrPull",
            "StorageBlobDataReader",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external": true,
          "service_name": "dataingest",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "DATA_INGEST_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "CosmosDBBuiltInDataContributor",
            "AcrPull",
            "SearchIndexDataContributor",
            "StorageBlobDataContributor",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external": true,
          "service_name": "mcp",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "MCP_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "CosmosDBBuiltInDataContributor",
            "AcrPull",
            "SearchIndexDataContributor",
            "StorageBlobDataContributor",
            "StorageQueueDataContributor",
            "KeyVaultSecretsUser"
          ]
        }
      ]
    }
  }
}
 